# NetGuard Pro 项目上下文指南

## 项目概述
NetGuard Pro 是一款专为 Windows 系统设计的现代化端口管理与安全监控工具。它采用 Python 3 开发，基于 Tkinter 框架构建，旨在为开发者和系统管理员提供比原生 `netstat` 命令更直观、更高效的交互体验。

### 核心功能
*   **多维度端口查询**：支持单端口、多端口（逗号分隔）及端口范围（如 `8000-9000`）的实时占用查询。
*   **现代化表格视图**：通过 Treeview 实现高性能的数据展示，支持点击表头排序及多选操作。
*   **进程深度管理**：一键执行进程终止（Kill）或自动拉起重启（Restart），支持批量操作。
*   **智能标签筛选系统**：
    *   **动态标签**：根据当前活跃端口自动生成点击即选的胶囊按钮。
    *   **自定义组**：支持用户定义常用的端口组（如 "数据库"、"Web服务"）并持久化存储。
*   **实时连接监控**：后台线程每隔 2 秒扫描指定端口，并在反馈日志区高亮显示异常连接活动。
*   **性能优化**：引入分片渲染（Chunk Rendering）技术，确保在处理上千个端口数据时界面依然丝滑响应。

## 技术栈
*   **编程语言**：Python 3.x
*   **图形界面**：Tkinter (ttk)
*   **核心库**：
    *   `psutil`：用于跨平台的进程和系统监控。
    *   `subprocess`：执行底层网络指令及拉起新进程。
    *   `threading`：实现非阻塞的后台扫描与监控。
*   **数据持久化**：JSON 格式 (`port_history.json`, `port_groups.json`)

## 文件结构
*   `port_manager.py`：主程序逻辑，包含 UI 定义、多线程控制、进程管理及标签系统。
*   `netguard_hotreload.py`：热加载启动器，监控源码变化并自动重启子进程，提升开发效率。
*   `启动NetGuard.bat`：Windows 批处理启动脚本，默认进入热加载模式。
*   `requirements.txt`：项目依赖清单（主要是 `psutil`）。
*   `port_groups.json`：存储用户自定义的端口组配置。
*   `port_history.json`：存储用户的端口查询历史。

## 运行与开发
### 环境准备
```bash
pip install -r requirements.txt
```

### 启动程序
*   **生产/使用模式**：直接运行 `python port_manager.py` 或 `启动NetGuard.bat`。
*   **开发调试模式**：运行 `python netguard_hotreload.py`，修改代码保存后界面会自动刷新。

## 开发约定
*   **UI 布局**：采用侧边栏布局（左侧 380px 固定宽度控制区，右侧自适应表格区）。
*   **交互逻辑**：
    *   高频操作（重启、终止、详情）必须通过表格上方的快捷工具栏外显。
    *   耗时操作（如扫描、监控）必须在子线程执行，并通过 `root.after` 安全更新 UI。
*   **样式规范**：
    *   **字体**：Windows 首选 `Microsoft YaHei UI`，等宽字体使用 `Consolas`。
    *   **配色**：使用 `primary (#2563EB)` 作为品牌色，`danger (#EF4444)` 代表破坏性操作。
*   **性能**：列表更新前必须清空 `Treeview` 缓存，大量数据插入时建议使用分片处理以防主线程阻塞。
